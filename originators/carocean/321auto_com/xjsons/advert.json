{
    "name": "advert_321auto_com",
    "test_url" : "http://occasion.321auto.com/occasion-auto/annonce-46189035.html",
    "version": 0,
    "versions": [{
        "version" : 0,
        "timestamp" : 1345450889,
        "config" : {
            "xpath" : {
                "root" : "/html:html",
                "namespaces" : {
                    "html": "http://www.w3.org/1999/xhtml"
                }
            },
            "anomaly" : {
                "root" : "/html:html",
                "namespaces" : {

                }
            }
        },
        "anomaly" : {},
        "light_handlers" : {
            "^html:" : {},
            "^replace:postal_code" : [{
                    "from_re": "^.*\\(",
                    "to": ""
                },
                {
                    "from_re": "\\).*$",
                    "to": ""
                }
            ],
            "^replace:department" : [{
                    "from_re": " \\(\\d+\\).*$",
                    "to": ""
                },
                {
                    "from_re": "^.* ",
                    "to": ""
                }
            ],
            "^replace:city" : [{
                "from_re": ".*\\) ",
                "to": ""
            }],
            "^replace:price_currency" : [{
                "from_re": "^.* ",
                "to": ""
            }],
            "^replace:mileage" : [{
                "from_re": " .*$",
                "to": ""
            },{
                "comment" : "is not space, is special character",
                "from_str": " ",
                "to": ""
            }],
            "^replace:price_value" : [{
                "from_re": " .$",
                "to": ""
            },
                {
                    "from_str": " ",
                    "to": ""
                }
            ],
            "^drain:year" : {
                "re": "(\\d{4}) \\(",
                "group": 1
            },
            "^default:year" : 0,
            "^hash_map:regions" : {
                "map" : {
                    "67 68" : "Alsace",
                    "24 33 40 47 64" : "Aquitaine",
                    "03 15 43 63" : "Auvergne",
                    "14 50 61" : "Basse-Normandie",
                    "21 58 71 89" : "Bourgogne",
                    "22 29 35 56" : "Bretagne",
                    "18 28 36 37 41 45" : "Centre",
                    "08 10 51 52" : "Champagne-Ardenne",
                    "2A 2B 20" : "Corse",
                    "25 39 70 90" : "Franche-Comté",
                    "971" : "Guadeloupe",
                    "973" : "Guyane",
                    "27 76" : "Haute-Normandie",
                    "75 77 78 91 92 93 94 95" : "Île-de-France",
                    "974" : "La Réunion",
                    "11 30 34 48" : "Languedoc-Roussillon",
                    "19 23 87" : "Limousin",
                    "54 55 57 88" : "Lorraine",
                    "972" : "Martinique",
                    "976" : "Mayotte",
                    "09 12 31 32 46 65 81 82" : "Midi-Pyrénées",
                    "59 62" : "Nord-Pas-de-Calais",
                    "44 49 53 72 85" : "Pays de la Loire",
                    "02 60 802" : "Picardie",
                    "16 17 79 86" : "Poitou-Charentes",
                    "04 05 06 13 83 84" : "Provence-Alpes-Côte d'Azur",
                    "01 07 26 38 42 69 73 74" : "Rhône-Alpes"
                },
                "default" : "unknown",
                "separator" : " ",
                "operator" : "in"
            }
        },
        "rules" : {

            "title_tag" : ["mandatory",  "./html:head/html:title", {
                "postal_code": ["text.|^replace:postal_code|mandatory",  ".", "#ALFA ROMEO GIULIETTA 1.6 JTDm Sélective S&S 2011 occasion Diesel PACA Bouches-du-Rhône (13) LA CIOTAT"],
                "department": ["text.|^replace:department|mandatory",  ".", "#see .postal_code"],
                "city" : ["text.|^replace:city|mandatory",  ".", "#see .postal_code"],
                "#region" : ["HAS region in title text.|^replace:postal_code|^hash_map:regions|mandatory",  "."]
            }],
            "title" : ["text.|mandatory",  ".//html:span[@id='titreDetail']"],
            "info_vehicule" : ["optional",  ".//html:div[@id='infosVehicule']", {
                "price" : ["optional",  "./html:ul[last()]/html:li[1]/html:span[1]", {
                    "currency" : ["text.|^replace:price_currency|mandatory",  "."],
                    "value" : ["text.|^replace:price_value|float.|int.|mandatory",  "."]
                }],
                "details" : [ "mandatory", "./html:ul[1]", {
                    "year" : ["text.|^drain:year|int.|^default:year|mandatory",  "./html:li[1]/text()", "#2011 (29/07/2011)"],
                    "#TODO bug mileage" : ["^html:|mandatory",  "./html:li/text()"],
                    "mileage" : ["text.|^replace:mileage|int.|mandatory",  "./html:li[contains(text(), ' km')]/text()"]
                }]
            }],
            "description" : ["text.|mandatory",  ".//html:div[@id='DetailCommentaires']//html:p[@class='contenuDetail']"],
            "specification" : ["text.join_by_new_line|mandatory",  ".//html:div[@id='DetailEquipement']//html:ul/html:li/text()"]
        },
        "renames" : {},
        "blocks" : { }
    }]
}